[id="ocp-4-8-release-notes"]
= {product-title} {product-version} release notes
include::modules/common-attributes.adoc[]
:context: release-notes

toc::[]

Red Hat {product-title} provides developers and IT organizations with a hybrid cloud application platform for deploying both new and existing applications on secure, scalable resources with minimal configuration and management overhead. {product-title} supports a wide selection of programming languages and frameworks, such as Java, JavaScript, Python, Ruby, and PHP.

Built on {op-system-base-full} and Kubernetes, {product-title} provides a more secure and scalable multi-tenant operating system for today's enterprise-class applications, while delivering integrated application runtimes and libraries. {product-title} enables organizations to meet security, privacy, compliance, and governance requirements.

[id="ocp-4-8-about-this-release"]
== About this release

// TODO: Update k8s link once there is a version-specific URL for the Kubernetes release
{product-title} (link:https://access.redhat.com/errata/RHBA-2021:1234[RHBA-2021:1234]) is now available. This release uses link:https://kubernetes.io/docs/setup/release/notes/[Kubernetes 1.21] with CRI-O runtime. New features, changes, and known issues that pertain to {product-title} {product-version} are included in this topic.

//Red Hat did not publicly release {product-title} 4.8.0 as the GA version and, instead, is releasing {product-title} 4.8.z as the GA version.

{product-title} {product-version} clusters are available at https://cloud.redhat.com/openshift. The {cloud-redhat-com} application for {product-title} allows you to deploy OpenShift clusters to either on-premise or cloud environments.

{product-title} {product-version} is supported on {op-system-base-full} 7.7 or later, as well as {op-system-first} 4.6.

You must use {op-system} machines for the control plane, which are also known as master machines, and you can use either {op-system} or {op-system-base-full} 7.7 or later for compute machines, which are also known as worker machines.

[IMPORTANT]
====
Because only {op-system-base-full} version 7.7 or later is supported for compute machines, you must not upgrade the {op-system-base} compute machines to version 8.
====

//{product-title} 4.6 is an Extended Update Support (EUS) release. More information on Red Hat OpenShift EUS is available in link:https://access.redhat.com/support/policy/updates/openshift#ocp4_phases[OpenShift Life Cycle] and link:https://access.redhat.com/support/policy/updates/openshift-eus[OpenShift EUS Overview].

With the release of {product-title} 4.8, version 4.5 is now end of life. For more information, see the link:https://access.redhat.com/support/policy/updates/openshift[Red Hat OpenShift Container Platform Life Cycle Policy].

[id="ocp-4-8-inclusive-language"]
== Making open source more inclusive

Red Hat is committed to replacing problematic language in our code, documentation, and web properties. We are beginning with these four terms: master, slave, blacklist, and whitelist. Because of the enormity of this endeavor, these changes will be implemented gradually over several upcoming releases. For more details, see link:https://www.redhat.com/en/blog/making-open-source-more-inclusive-eradicating-problematic-language[Red Hat CTO Chris Wright’s message].

[id="ocp-4-8-new-features-and-enhancements"]
== New features and enhancements

This release adds improvements related to the following components and concepts.

[id="ocp-4-8-rhcos"]
=== {op-system-first}


[id="ocp-4-8-installation-and-upgrade"]
=== Installation and upgrade


[id="ocp-4-8-web-console"]
=== Web console


[id="ocp-4-8-security"]
=== Security and compliance


[id="ocp-4-8-networking"]
=== Networking

[id="ocp-4-8-supported-hardware-sriov"]
==== Supported hardware for SR-IOV

{product-title} {product-version} adds support for additional Intel and Mellanox hardware.

* Intel X710 and XL710 controllers
* Four Intel E810 family controllers: E810-CQDA2, E810-2CQDA2, E810-XXVDA2, E810-XXVDA4
* Mellanox ConnectX-5 Ex

For more information, see the xref:../networking/hardware_networks/about-sriov.adoc#supported-devices_about-sriov[supported devices].

[id="ocp-4-8-storage"]
=== Storage


[id="ocp-4-8-registry"]
=== Registry


[id="ocp-4-8-operators"]
=== Operator lifecycle


[id="ocp-4-8-images"]
=== Images


[id="ocp-4-8-machine-api"]
=== Machine API


[id="ocp-4-8-nodes"]
=== Nodes

[id="ocp-4-8-nodes-descheduler-apigroup"]
==== Descheduler operator.openshift.io/v1 API group is now available

The `operator.openshift.io/v1` API group is now available for the descheduler. Support for the `operator.openshift.io/v1beta1` API group for the descheduler might be removed in a future release.

[id="ocp-4-8-nodes-descheduler-metrics"]
==== Prometheus metrics for the descheduler

You can now enable Prometheus metrics for the descheduler by adding the `openshift.io/cluster-monitoring=true` label to the `openshift-kube-descheduler-operator` namespace where you installed the descheduler.

The following descheduler metrics are available:

* `descheduler_build_info` - Provides build information about the descheduler.
* `descheduler_pods_evicted` - Provides the number of pods that have been evicted for each combination of strategy, namespace, and result. There must be at least one evicted pod for this metric to appear.

[id="ocp-4-8-logging"]
=== Cluster logging


[id="ocp-4-8-monitoring"]
=== Monitoring


[id="ocp-4-8-scale"]
=== Scale
==== Support for the OpenNESS operator for Intel® FPGA PAC N3000
{product-title} 4.8 supports the OpenNESS operator for Intel® FPGA PAC N3000. The operator:

* Orchestrates and manages the resources/devices exposed by the Intel® FPGA PAC N3000 card within OpenShift.
* Provides functionality to load the necessary drivers.
* Allows the user to program the Intel® FPGA PAC N3000 user image.
* Enables the update of the Intel® XL710 NICs (Network Interface Cards) firmware.

For vRAN use-cases the operator is used alongside the additionally supported OpenNESS Operator for Intel Wireless FEC Accelerator.
This operator is a common operator for FEC device/resource management for a range of accelerator cards for example:

* Intel® FPGA PAC N3000
* Intel® vRAN dedicated accelerator ACC100 (Mount Bryce)


[id="ocp-4-8-dev-exp"]
=== Developer experience


[id="ocp-4-8-notable-technical-changes"]
== Notable technical changes

{product-title} 4.8 introduces the following notable technical changes.

[id="ocp-4-8-deprecated-removed-features"]
== Deprecated and removed features

Some features available in previous releases have been deprecated or removed.

Deprecated functionality is still included in {product-title} and continues to be supported; however, it will be removed in a future release of this product and is not recommended for new deployments. For the most recent list of major functionality deprecated and removed within {product-title} {product-version}, refer to the table below. Additional details for more fine-grained functionality that has been deprecated and removed are listed after the table.

In the table, features are marked with the following statuses:

* *GA*: _General Availability_
* *DEP*: _Deprecated_
* *REM*: _Removed_

//TODO: remove anything that has been REM since 4.6

.Deprecated and removed features tracker
[cols="3,1,1,1",options="header"]
|====
|Feature |OCP 4.6 |OCP 4.7 |OCP 4.8

|`OperatorSource` objects
|REM
|REM
|

|Package Manifest Format (Operator Framework)
|DEP
|DEP
|

|`oc adm catalog build`
|DEP
|DEP
|

|`--filter-by-os` flag for `oc adm catalog mirror`
|GA
|DEP
|

|v1beta1 CRDs
|DEP
|DEP
|

|Docker Registry v1 API
|DEP
|DEP
|

|Metering Operator
|DEP
|DEP
|

|Scheduler policy
|GA
|DEP
|

|`ImageChangesInProgress` condition for Cluster Samples Operator
|GA
|DEP
|

|`MigrationInProgress` condition for Cluster Samples Operator
|GA
|DEP
|

|Use of `v1` in `apiVersion` for {product-title} resources
|GA
|DEP
|

|====

[id="ocp-4-8-deprecated-features"]
=== Deprecated features

[id="ocp-4-8-descheduler-apigroup-deprecated"]
==== Descheduler operator.openshift.io/v1beta1 API group is deprecated

The `operator.openshift.io/v1beta1` API group for the descheduler is deprecated and might be removed in a future release. Use the `operator.openshift.io/v1` API group instead.

[id="ocp-4-8-removed-features"]
=== Removed features

[id="ocp-4-8-images-removed-from-samples-imagestreams"]
==== Images removed from samples imagestreams

The following images are no longer included in the samples imagestreams provided with {product-title}:

----
registry.redhat.io/rhscl/nodejs-10-rhel7
registry.redhat.io/ubi7/nodejs-10
registry.redhat.io/rhscl/perl-526-rhel7
registry.redhat.io/rhscl/postgresql-10-rhel7
registry.redhat.io/rhscl/ruby-25-rhel7
registry.redhat.io/ubi7/ruby-25
registry.redhat.io/rhdm-7/rhdm-decisioncentral-rhel8:7.9.0
registry.redhat.io/rhdm-7/rhdm-kieserver-rhel8:7.9.0
registry.redhat.io/rhpam-7/rhpam-businesscentral-monitoring-rhel8:7.9.0
registry.redhat.io/rhpam-7/rhpam-businesscentral-rhel8:7.9.0
registry.redhat.io/rhpam-7/rhpam-smartrouter-rhel8:7.9.0
----

[id="ocp-4-8-bug-fixes"]
== Bug fixes

[id="ocp-4-8-technology-preview"]
== Technology Preview features

Some features in this release are currently in Technology Preview. These experimental features are not intended for production use. Note the following scope of support on the Red Hat Customer Portal for these features:

link:https://access.redhat.com/support/offerings/techpreview[Technology Preview Features Support Scope]

In the table below, features are marked with the following statuses:

* *TP*: _Technology Preview_
* *GA*: _General Availability_
* *-*: _Not Available_

//TODO: remove anything that has been GA since 4.6

.Technology Preview tracker
[cols="4,1,1,1",options="header"]
|====
|Feature |OCP 4.6 |OCP 4.7 |OCP 4.8

|Precision Time Protocol (PTP)
|TP
|TP
|

|`oc` CLI Plug-ins
|TP
|TP
|

|Descheduler
|TP
|GA
|GA

|OVN-Kubernetes Pod network provider
|GA
|GA
|

|HPA custom metrics adapter based on Prometheus
|TP
|TP
|

|HPA for memory utilization
|TP
|GA
|

|Service Binding
|TP
|GA
|

|Log forwarding
|GA
|GA
|

|Monitoring for user-defined projects
|GA
|GA
|

|Raw Block with Cinder
|TP
|TP
|

|External provisioner for AWS EFS
|TP
|TP
|

|CSI volume snapshots
|TP
|GA
|

|CSI volume cloning
|GA
|GA
|

|CSI volume expansion
|TP
|TP
|

|vSphere Problem Detector Operator
|-
|GA
|

|CSI GCP PD Driver Operator
|-
|TP
|

|CSI OpenStack Cinder Driver Operator
|-
|TP
|

|CSI AWS EBS Driver Operator
|TP
|TP
|

|Red Hat Virtualization (oVirt) CSI Driver Operator
|GA
|GA
|

|CSI inline ephemeral volumes
|TP
|TP
|

|Automatic device discovery and provisioning with Local Storage Operator
|TP
|TP
|

|OpenShift Pipelines
|TP
|TP
|

|OpenShift GitOps
|TP
|TP
|

|Vertical Pod Autoscaler
|TP
|TP
|

|Operator API
|GA
|GA
|

|Adding kernel modules to nodes
|TP
|TP
|

|Egress router CNI plug-in
|-
|TP
|

|Scheduler profiles
|-
|TP
|TP

|Non-preempting priority classes
|-
|TP
|TP

|Kubernetes NMState Operator
|-
|TP
|

|Assisted Installer
|-
|TP
|

|====

[id="ocp-4-8-known-issues"]
== Known issues

// TODO: This known issue should carry forward to 4.8 and beyond!
* In {product-title} 4.1, anonymous users could access discovery endpoints. Later releases revoked this access to reduce the possible attack surface for security exploits because some discovery endpoints are forwarded to aggregated API servers. However, unauthenticated access is preserved in upgraded clusters so that existing use cases are not broken.
+
If you are a cluster administrator for a cluster that has been upgraded from {product-title} 4.1 to 4.8, you can either revoke or continue to allow unauthenticated access. It is recommended to revoke unauthenticated access unless there is a specific need for it. If you do continue to allow unauthenticated access, be aware of the increased risks.
+
[WARNING]
====
If you have applications that rely on unauthenticated access, they might receive HTTP `403` errors if you revoke unauthenticated access.
====
+
Use the following script to revoke unauthenticated access to discovery endpoints:
+
[source,bash]
----
## Snippet to remove unauthenticated group from all the cluster role bindings
$ for clusterrolebinding in cluster-status-binding discovery system:basic-user system:discovery system:openshift:discovery ;
do
### Find the index of unauthenticated group in list of subjects
index=$(oc get clusterrolebinding ${clusterrolebinding} -o json | jq 'select(.subjects!=null) | .subjects | map(.name=="system:unauthenticated") | index(true)');
### Remove the element at index from subjects array
oc patch clusterrolebinding ${clusterrolebinding} --type=json --patch "[{'op': 'remove','path': '/subjects/$index'}]";
done
----
+
This script removes unauthenticated subjects from the following cluster role bindings:
+
--
** `cluster-status-binding`
** `discovery`
** `system:basic-user`
** `system:discovery`
** `system:openshift:discovery`
--
+
(link:https://bugzilla.redhat.com/show_bug.cgi?id=1821771[*BZ#1821771*])

[id="ocp-4-8-asynchronous-errata-updates"]
== Asynchronous errata updates

Security, bug fix, and enhancement updates for {product-title} 4.8 are released as asynchronous errata through the Red Hat Network. All {product-title} 4.8 errata is https://access.redhat.com/downloads/content/290/[available on the Red Hat Customer Portal]. See the https://access.redhat.com/support/policy/updates/openshift[{product-title} Life Cycle] for more information about asynchronous errata.

Red Hat Customer Portal users can enable errata notifications in the account settings for Red Hat Subscription Management (RHSM). When errata notifications are enabled, users are notified via email whenever new errata relevant to their registered systems are released.

[NOTE]
====
Red Hat Customer Portal user accounts must have systems registered and consuming {product-title} entitlements for {product-title} errata notification emails to generate.
====

This section will continue to be updated over time to provide notes on enhancements and bug fixes for future asynchronous errata releases of {product-title} 4.8. Versioned asynchronous releases, for example with the form {product-title} 4.8.z, will be detailed in subsections. In addition, releases in which the errata text cannot fit in the space provided by the advisory will be detailed in subsections that follow.

[IMPORTANT]
====
For any {product-title} release, always review the instructions on xref:../updating/updating-cluster.adoc#updating-cluster[updating your cluster] properly.
====

[id="ocp-4-8-0-ga"]
=== RHBA-2021:1234 - {product-title} 4.8.0 image release, bug fix, and security update advisory

Issued: 2021-xx-xx

{product-title} release 4.8.0, which includes security updates, is now available. The list of bug fixes that are included in the update is documented in the link:https://access.redhat.com/errata/RHBA-2021:1234[RHBA-2021:1234] advisory. The RPM packages that are included in the update are provided by the link:https://access.redhat.com/errata/RHBA-2021:5678[RHBA-2021:5678] advisory.

Space precluded documenting all of the container images for this release in the advisory. See the following article for notes on the container images in this release:

link:https://access.redhat.com/solutions/<ARTICLE_ID>[{product-title} 4.8.0 container image list]
