// Telcodocs-403 assembly
:_content-type: ASSEMBLY
[id="ztp-factory-workflows"]
= Zero touch provisioning (ZTP) for factory workflows
include::_attributes/common-attributes.adoc[]
:context: ztp-factory-install

:FeatureName: ZTP for factory workflows

include::snippets/technology-preview.adoc[leveloffset=+1]

toc::[]
Zero touch provisioning (ZTP) for factory workflows accelerates the deployment of OpenShift with pre-certified hardware and software for rapid edge deployments.

ZTP for factory workflows enables original equipment manufacturer (OEM) partners to pre-install OpenShift at their factory and build turnkey solutions on their hardware. This approach is well suited to a range of different industries such as healthcare, manufacturing, aerospace, to media, entertainment, retail, and telecommunications.

ZTP for factory workflows installs the components that enable you to use {product-title} as a disconnected hub cluster. This hub cluster is then able to deploy edge clusters that can be shipped off site for final configuration.

At the factory, the OEM partner first deploys a hub {product-title} cluster and then uses the hub cluster to deploy one or more edge clusters at scale.

This compact {product-title} cluster hub uses {rh-rhacm-first} (ACM) and the assisted installer (AI) to install edge clusters at scale by using zero touch provisioning (ZTP). The compact hub cluster can deploy a 3 + 1 (3 control plane nodes and 1 worker node) or a compact (3 control plane nodes also able to act as worker nodes) edge cluster.

When the edge cluster is installed, it can be shipped to the customer on-premise locations and there the end customer unboxes it, and configures the edge cluster making it fully operational.

A high level overview of the zero touch provisioning (ZTP) for factory workflows is as follows:

== Create the hub cluster

* Install the {product-title} hub cluster in a factory setting.
* Install OpenShift Data Foundation on the hub cluster.
* Install the factory pipeline tooling and pipeline.
* Disconnect the hub cluster from the internet.
* Create bootstrapping IP address pool.

== Create and ship the edge cluster

* Create the edge cluster.
* Connect the edge cluster.
* Start the pipeline.
* Disconnect the edge cluster.

== Configure the edge cluster

* Configure the edge cluster on-site.
* Connect the edge cluster to customer's on site network.
* Configure the edge cluster.
* Disconnect from customer's cluster network.
* Configure site DNS for the edge cluster.

include::modules/ztp-create-factory-hub-cluster.adoc[leveloffset=+1]

.Additional resources

For more information about:

* Openshift pipelines, see xref:../cicd/pipelines/understanding-openshift-pipelines.adoc#understanding-openshift-pipelines[Understanding OpenShift Pipelines].

* Installing {product-title}, see xref:../installing/installing_bare_metal_ipi/ipi-install-overview.adoc#ipi-install-overview[Installer provisioned overview].

* Installing the Local Storage Operator, see xref:../storage/persistent_storage/persistent-storage-local.adoc[Persistent storage using local volumes].

* Deploying {product-title} Data Foundation, see link:https://access.redhat.com/documentation/en-us/red_hat_openshift_data_foundation/4.9/html/deploying_openshift_data_foundation_using_bare_metal_infrastructure/index[Deploying OpenShift Data Foundation using bare metal infrastructure].

include::modules/ztp-intro-factory-install.adoc[leveloffset=+1]

include::modules/ztp-install-factory-pipeline-overview.adoc[leveloffset=+1]

include::modules/ztp-install-factory-hubspoke-architecture.adoc[leveloffset=+1]

include::modules/ztp-hub-factory-pipeline.adoc[leveloffset=+2]


.Additional resources

* For more information about:

** `opm` and `oc`, see xref:../cli_reference/index.adoc#cli-tools-overview[CLI tools overview].
** Installing Red Hat Advanced Cluster Management (RHACM), see link:https://access.redhat.com/documentation/en-us/red_hat_advanced_cluster_management_for_kubernetes/2.4/html/install/installing[Install and uninstall Red Hat Advanced Cluster Management].
*  Enabling the assisted installer on {product-title}, see xref:../scalability_and_performance/ztp-deploying-disconnected.adoc#enabling-assisted-installer-service-on-bare-metal_ztp-deploying-disconnected[Enabling assisted installer service on bare metal].

include::modules/ztp-spoke-factory-pipeline.adoc[leveloffset=+2]

include::modules/ztp-pre-hub-install-factory-pipeline-checks.adoc[leveloffset=+1]

.Additional resources

For more information about:

* The NMState Operator see, xref:../networking/k8s_nmstate/k8s-nmstate-about-the-k8s-nmstate-operator.adoc[About the Kubernetes NMState Operator].

include::modules/ztp-install-openshift-pipelines.adoc[leveloffset=+1]

include::modules/ztp-install-factory-pipeline.adoc[leveloffset=+1]

.Additional resources

For more information about the supported flags and arguments see, xref:../scalability_and_performance/ztp-factory-install-clusters.adoc#ztp-factory-install-pipelines-flags-arguments_ztp-factory-install[ZTP factory install pipelines flags and arguments].

include::modules/ztp-check-install-hub-factory-pipeline.adoc[leveloffset=+2]

include::modules/ztp-post-install-hub-factory-pipeline-checks.adoc[leveloffset=+2]

include::modules/ztp-install-factory-spoke-pipeline.adoc[leveloffset=+1]

include::modules/ztp-check-install-spoke-factory-pipeline.adoc[leveloffset=+2]

include::modules/ztp-post-install-spoke-factory-pipeline-checks.adoc[leveloffset=+2]

include::modules/ztp-troubleshooting-factory-pipelines.adoc[leveloffset=+1]

include::modules/ztp-common-expected-errors.adoc[leveloffset=+1]

include::modules/ztp-configuring-spoke-at-remote-site.adoc[leveloffset=+1]

include::modules/ztpfw-pipelines-flags-arguments.adoc[leveloffset=+1]

[id="{context}-additional-resources"]
== Additional resources
* For more information about the {product-title} GitOps see xref:../cicd/gitops/understanding-openshift-gitops.adoc#understanding-openshift-gitops[Understanding OpenShift GitOps].
* For more information about the {product-title} Pipelines see xref:../cicd/pipelines/understanding-openshift-pipelines.adoc#understanding-openshift-pipelines[Understanding OpenShift Pipelines].
