// Module included in the following assemblies:
//
// * scalability_and_performance/ztp-factory-install-clusters.adoc
:_content-type: CONCEPT
[id="hub-factory-pipeline_{context}"]
= Configuring the Hub factory cluster

Configure the hub cluster to support deploying multiple spoke clusters as follows. configuration pipeline stage prepares the hub cluster to deploy multiple edge clusters for the end customer.

Perform the following checks before any steps are executed to ensure the hub cluster is in the correct state. Verify

* `jq`, `oc`, `opm` and `kubectl` are installed on the hub cluster.
* {product-title} version 4.10.9 or greater is installed.
* Nodes are ready.
* Cluster Operators are ready.
* Metal3 pods are ready.
* Persistent volumes are created.
* DNS requirements are satisfied.

The key steps in configuring the hub cluster:

. Deploy an HTTPD server. Obtain the Red Hat Enterprise Linux CoreOS (RHCOS) ISO and RootFS images from link:https://mirror.openshift.com/pub/openshift-v4/dependencies/rhcos/pre-release/[mirror.openshift.com] and ensures these are hosted on the deployed HTTPD server. These are then available to install on the edge cluster.

. Deploy a registry. Substeps involve:
   .. Sync the {product-title} and Operator Lifecycle Manager (OLM) images from Quay and Red Hat registries to the internal registry.
   .. Update the pull secret globally.

. Deploy Red Hat Advanced Cluster Manager and Assisted Installer.
  Red Hat Advanced Cluster Manager manages the deployment on many managed edge clusters.

. Deploy the ImageContentSourcePolicy (ISCP) and the Catalog sources for the hub to point to itself as a source of the images and operator. From this step forward, the hub cluster is no longer connected to the Internet.

. Configure the Assisted Installer. This step ensures the Assisted Installer service supports installing the edge clusters. This step configures the way the edge cluster is deployed, the certificates, the image sources, the cluster details, and so on.

When these steps are followed the hub cluster is ready to install the edge cluster.
