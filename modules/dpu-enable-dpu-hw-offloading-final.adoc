// Module included in the following assemblies:
//CC-3 (alongside 4.10 dev preview)
// * hardware_enablement/dpu-hardware-offload.adoc


:_content-type: PROCEDURE
[id="dpu-enable-dpu-hardware-offloading-final_{context}"]
= Final infrastructure cluster configuration

Run the following steps against the infrastructure cluster.

. Add the `kubeconfig` of the tenant cluster as a secret.
+
[source,terminal]
----
$ oc create secret generic tenant-cluster-1-kubeconf -n tenantcluster-dpu --from-file=config=/root/kubeconfig.tenant
----

. Add the per node configuration override for the `ovnkube-node` by listing all the DPU nodes under `:data`:
+
[source,yaml]
----
kind: ConfigMap
apiVersion: v1
metadata:
  name: env-overrides
  namespace: tenantcluster-dpu
data:
  worker-bf: |
    TENANT_K8S_NODE=x86-worker-node0
    DPU_IP=192.168.111.29
    MGMT_IFNAME=pf0vf0
----

. Update the `OvnkubeConfig` CR by adding the `kubeConfigFile` field. Wait until the `ovnkube` pods are created.
+
[source,yaml]
----
apiVersion: dpu.openshift.io/v1alpha1
kind: OVNKubeConfig
metadata:
  name: ovnkubeconfig-sample
spec:
  kubeConfigFile: tenant-cluster-1-kubeconf
  poolName: dpu
  nodeSelector:
    matchLabels:
      node-role.kubernetes.io/dpu-worker: ''
----

In the DPU Network Operator there are several status messages that can be used to verify the Operator's working status:

* `McpReady` indicates that the MachineConfig and MachineConfigPool are ready.
* `TenantObjsSynced` indicates that the tenant ConfigMap and secrets are synced to the infrastructure nodes.
* `OvnKubeReady` indicates that the `ovnkube-node` DaemonSet is ready.
