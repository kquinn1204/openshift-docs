// Module included in the following assemblies:
//
// * scalability_and_performance/ztp-factory-install-clusters.adoc
:_content-type: PROCEDURE
[id="run-the-hub-cluster-factory-install-pipeline_{context}"]
= Run the hub cluster factory install pipeline

Follow the guidance here to run the hub factory install pipeline.

.Prerequisites

* An {product-title} hub cluster.
* Log in as a user with `cluster-admin` privileges.

.Procedure

. Create a file `spokes.yaml` with sample details as shown. A sample configuration file is present in `examples/config.yaml`.
+
[NOTE]
====
At this stage you only need to build out the `config` section. The `config` section specifies the cluster configuration values used to install and configure the hub and edge cluster.
====
+
[source,yaml]
----
config:
  clusterimageset: openshift-v4.9.0 <1>
  OC_OCP_VERSION: "4.9" <2>
  OC_OCP_TAG: "4.9.0-x86_64" <3>
  OC_RHCOS_RELEASE: "49.84.202110081407-0" <4>
  OC_ACM_VERSION: "2.4" <5>
  OC_OCS_VERSION: "4.8" <6>
----
+
<1> The cluster image set used for the hub and the edge clusters.
<2> {product-title} version of the edge cluster.
<3> Defines the version tag to use.
<4> Red Hat Enterprise Linux CoreOS (RHCOS) version.
<5> Red Hat Advanced Cluster Management (RHACM) version.
<6> The OpenShift Data Foundation (ODF) version.

. Start the hub cluster pipeline from the command line:
+
[source,terminal]
----
$ tkn pipeline start -n spoke-deployer -p git-revision=main spokes-config="$(cat /path-to-spoke.yaml/spokes.yaml)" -p kubeconfig=${KUBECONFIG} -w=ztp,claimName=ztp-pvc --timeout 5h --use-param-defaults deploy-ztp-hub
----
+
[NOTE]
====
This command starts the pipeline in the namespace `spoke-deployer` with the defined edge cluster configuration and the `kube` configuration in the workspace `ztp` with the previously configured persistent storage claim `ztp-pvc`. A timeout of 5 hours is set for the execution of the `deploy-ztp-hub` with all other parameters set to the default.
====
+
.Example output
+
[source,terminal]
----
PipelineRun started: deploy-ztp-hub-run-2h44k

In order to track the PipelineRun progress run:
tkn pipelinerun logs deploy-ztp-hub-run-2h44k -f -n spoke-deployer
----
